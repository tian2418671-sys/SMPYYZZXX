# 🔧 SPM扩展 "基础模式" 问题解决指南

## 📋 问题描述

您看到的提示：
```
📊 SPM Status Monitor v8.4.0
基础模式已激活
完整功能需要SillyTavern环境和正确的扩展加载
```

这说明扩展**检测到了问题**，只能以**基础模式**运行，而不是完整功能模式。

## 🔍 问题分析

### 可能的原因

1. **SillyTavern环境检测失败**
   - 扩展无法识别当前在SillyTavern中运行
   - SillyTavern版本过旧或过新

2. **扩展文件加载问题**
   - `st-extension.js` 主文件加载失败
   - 文件路径不正确

3. **扩展安装位置错误**
   - 扩展文件夹放在了错误的位置
   - 文件权限问题

4. **浏览器兼容性问题**
   - 浏览器阻止了脚本加载
   - 安全设置过严

## ✅ 解决方案

### 方案1：检查安装位置 ⭐ (最常见)

**正确的安装路径应该是**：
```
SillyTavern/public/scripts/extensions/spm-status-monito/
├── manifest.json
├── main.js
├── st-extension.js
├── style.css
└── 其他文件...
```

**检查步骤**：
1. 确认扩展文件夹在 `SillyTavern/public/scripts/extensions/` 目录下
2. 文件夹名称必须是 `spm-status-monito`
3. 所有文件都完整存在

### 方案2：重新启用扩展

1. **在SillyTavern中**：
   - 点击扩展面板 (Extensions)
   - 找到 "SPM Status Monitor"
   - **取消勾选** → **重新勾选**
   - 刷新页面

2. **完全重启**：
   - 关闭SillyTavern
   - 重新启动SillyTavern
   - 重新启用扩展

### 方案3：检查浏览器控制台

1. **打开开发者工具** (F12)
2. **查看Console标签**
3. **查找错误信息**：
   ```
   🎯 检测到SillyTavern环境
   ✅ SPM Status Monitor 扩展脚本已加载
   🎯 SPM Status Monitor 完全激活
   ```

**如果看到错误**：
- `❌ SPM扩展脚本加载失败` → 文件路径问题
- `⚠️ 未检测到SillyTavern环境` → 环境检测问题
- `❌ SPM扩展初始化失败` → 兼容性问题

### 方案4：手动激活 (临时解决)

如果看到基础模式提示：

1. **点击基础模式按钮**
2. **选择 "尝试重新加载完整扩展"**
3. **等待1-2秒**
4. **查看是否出现成功提示**

### 方案5：强制刷新

1. **按 Ctrl+Shift+R** (强制刷新)
2. **清除浏览器缓存**：
   - Chrome: Ctrl+Shift+Delete
   - 选择 "缓存的图片和文件"
   - 点击清除
3. **重新启动浏览器**

### 方案6：检查SillyTavern版本

**兼容版本**：
- SillyTavern 1.10.0 或更新版本
- 支持扩展系统的版本

**检查方法**：
- 在SillyTavern中查看版本号
- 确保扩展面板可用

## 🎯 成功标志

**扩展正常工作时，您应该看到**：

1. **控制台信息**：
   ```
   🎯 检测到SillyTavern环境
   ✅ SPM Status Monitor 扩展脚本已加载  
   🎯 SPM Status Monitor 完全激活
   ```

2. **页面右下角出现SPM图标** 📊

3. **点击图标可以打开完整的监控面板**

4. **扩展面板中显示已启用**

## 🆘 仍然无法解决？

### 高级诊断

1. **检查文件完整性**：
   ```bash
   # 检查文件是否存在
   ls SillyTavern/public/scripts/extensions/spm-status-monito/
   
   # 应该看到:
   # manifest.json main.js st-extension.js style.css
   ```

2. **手动加载测试**：
   - 在浏览器控制台输入：
   ```javascript
   // 检查扩展是否存在
   console.log(window.spmMonitor);
   
   // 尝试手动初始化
   if(window.spmMonitor) {
       window.spmMonitor.init();
   }
   ```

3. **权限检查**：
   - 确保SillyTavern对扩展文件有读取权限
   - Windows: 检查文件属性中的安全设置

### 联系支持

如果以上方案都无效，请提供：

1. **SillyTavern版本**
2. **浏览器类型和版本**
3. **操作系统**
4. **浏览器控制台的完整错误信息**
5. **扩展安装路径截图**

---

## 🎉 快速修复版本

**我已经改进了扩展的检测逻辑**，修复包括：

1. **更强大的SillyTavern环境检测**
2. **更智能的脚本路径解析**
3. **更清楚的错误提示信息**
4. **自动重试和恢复机制**

**更新后，扩展会**：
- 更准确地检测SillyTavern环境
- 提供更详细的诊断信息
- 支持一键重新激活功能

**建议立即刷新页面测试新版本！** 🚀